(function(a){a.fn.ajaxPager=function(b){if(a.ajaxPager.methods[b]){return a.ajaxPager.methods[b].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof b==="object"||!b){return a.ajaxPager.methods.init.apply(this,arguments)}else{a.error("Method "+b+" does not exist on jQuery.ajaxPager")}var c={};var d={};var e={};var f=null;var g=null;var h=null;var i=null;var j=null};a.fn.ajaxPager.defaults={position:"top",classes:"",stripedrows:false,loadtext:"Loading...",page:1,limit:25,limitdd:true,limitoptions:[25,50,75,100],sortcolumn:null,sortdir:"asc",sortby:{},searchtext:null,ajaxoptions:{url:"",type:"POST",data:{},dataType:"json"},reader:{success:"success",message:"message",totalpages:"totalpages",totalrecords:"totalrecords",root:""},params:{start:"start",limit:"limit",page:"page",sort:"sort",dir:"dir",search:"search"},renderoutput:null,listeners:{init:null,render:null,preprocess:null,beforeload:null,load:null,destroy:null}};a.fn.ajaxPager.privatevars={dataloaded:false,rendered:false,totalpages:12,totalrecords:293,firstrecord:0,lastrecord:0,pagers:null};a.ajaxPager={methods:{init:function(b){var b=b||{};settings=a.extend(true,{},a.fn.ajaxPager.defaults,b);handlers=a.ajaxPager.handlers;getAccessor=a.ajaxPager._getAccessor;makeRequest=a.ajaxPager._makeRequest;changePage=a.ajaxPager._changePage;mask=a.ajaxPager._maskContent;unmask=a.ajaxPager._unmaskContent;return this.each(function(){var b=a(this),c=b.data("ajaxPager");b.bind("optionchange.ajaxPager",handlers.optionChangeHandler);b.bind("pagechange.ajaxPager",handlers.pageChangeHandler);b.bind("firstpage.ajaxPager",handlers.firstPageHandler);b.bind("previouspage.ajaxPager",handlers.previousPageHandler);b.bind("nextpage.ajaxPager",handlers.nextPageHandler);b.bind("lastpage.ajaxPager",handlers.lastPageHandler);b.bind("init.ajaxPager",handlers.initHandler);b.bind("render.ajaxPager",handlers.renderHandler);b.bind("beforeload.ajaxPager",handlers.beforeLoadHandler);b.bind("load.ajaxPager",handlers.loadHandler);b.bind("destroy.ajaxPager",handlers.destroyHandler);var d=a.ajaxPager._buildPagerBar(settings);b.wrap('<div class="ajaxPagerContainer" />').addClass("pagingContent");switch(settings.position){case"both":b.before(d).after(d);break;case"top":b.before(d);break;case"bottom":b.after(d);break}if(!c){b.data("ajaxPager",a.extend({},a.fn.ajaxPager.privatevars,{target:b,pagers:a(".pagingbar",b.parent()),origcontent:a(this).html()}))}b.trigger("init").trigger("render")})},destroy:function(){return this.each(function(){var b=a(this),c=b.data("ajaxPager");if(settings.listeners.destroy&&typeof settings.listeners.destroy==="function"){settings.listeners.destroy.call(b,"destroy")}b.unbind(".ajaxPager");a("a.paging-nav",c.pagers).unbind("click");if(!a.isEmptyObject(settings.sortby)){a("a.paging-filter",c.pagers).unbind("click")}if(settings.limitdd){a("a.paging-limit",c.pagers).unbind("click")}a(".navbar-form",c.pagers).unbind("submit");a(".navbar-form input",c.pagers).unbind("keypress");b.html(c.origcontent);c.pagers.remove();b.unwrap().removeClass("pagingContent");b.removeData("ajaxPager")})},option:function(b){var c=a.extend({},settings);var d=a(this);if(typeof b==="object"){settings=a.extend(true,settings,b)}else if(arguments.length===2){settings[arguments[0]]=arguments[1]}else{return settings[arguments[0]]}a.each(c,function(a,b){if(settings[a]!==b){d.trigger("optionchange",[a,b,settings[a]])}});return},reload:function(){var b=a(this),c=a(this).data("ajaxPager");a.ajaxPager._makeRequest.call(b,settings.page)}},handlers:{optionChangeHandler:function(b,c,d,e){var f=a(this),g=a(this).data("ajaxPager");switch(c){case"page":if(e>g.totalpages&&g.rendered&&g.dataloaded){settings.page=d;a('form[name="jump"] input[name="page"]',g.pagers).val(d);a.error('You have tried to set a "page" beyond the number of available pages')}else{f.trigger("pagechange",e)}break;case"classes":var h=g.pagers;if(!h.hasClass(e)){h.addClass(e)}break;case"searchtext":f.trigger("pagechange",1);break}},jumpFormHandler:function(b){b.preventDefault();var c=a(".pagingContent",a(this).closest(".pagingbar").parent());var d=a('input[name="page"]',a(this)).val();c.ajaxPager("option","page",d);return false},pageChangeHandler:function(b,c){var d=a(this),e=a(this).data("ajaxPager");var f=c;switch(c){case 1:f=1;break;case e.totalpages:f=e.totalpages;break;default:break}a.ajaxPager._makeRequest.call(a(this),f)},filterLinkHandler:function(b){b.preventDefault();var c=b.data.el,d=a(this).attr("rel"),e=a("i",a('a[rel="'+d+'"]')),f=e.attr("class"),g=c.data("ajaxPager"),h=a(".paging-filter",g.pagers),i="icon-arrow-down";a("i",h).removeClass("icon-arrow-up").removeClass("icon-arrow-down").removeClass("icon-").addClass("icon-");settings.sortcolumn=d;if(f==="icon-arrow-up"){settings.sortdir="desc";i="icon-arrow-down"}else if(f==="icon-arrow-down"){settings.sortdir="asc";i="icon-arrow-up"}else{settings.sortdir="desc"}e.removeClass("icon-").addClass(i);a("li.dropdown.open").removeClass("open");a.ajaxPager._makeRequest.call(c,settings.page);return false},limitLinkHandler:function(b){b.preventDefault();var c=b.data.el,d=a(this).attr("rel"),e=a(this).text(),f=a("i",a('a[rel="'+d+'"]')),g=f.attr("class"),h=c.data("ajaxPager"),i=a(".paging-limit",h.pagers);settings.limit=e;a("i",i).removeClass("icon-chevron-right").removeClass("icon-").addClass("icon-");f.removeClass("icon-").addClass("icon-chevron-right");a("li.dropdown.open").removeClass("open");a.ajaxPager._makeRequest.call(c,settings.page);return false},navLinkHandler:function(b){b.preventDefault();var c=b.data.el,d=a(this).attr("rel");if(!a(this).hasClass("disabled")){c.trigger(d+"page")}return false},firstPageHandler:function(b){a(this).trigger("optionchange",["page",settings.page,1])},previousPageHandler:function(b){a(this).trigger("optionchange",["page",settings.page,settings.page-1])},lastPageHandler:function(b){var c=a(this),d=a(this).data("ajaxPager");a(this).trigger("optionchange",["page",settings.page,d.totalpages])},nextPageHandler:function(b){a(this).trigger("optionchange",["page",settings.page,settings.page+1])},initHandler:function(){var b=a(this);if(settings.listeners.init&&typeof settings.listeners.init==="function"){settings.listeners.init.call(b,"init")}},renderHandler:function(b){var d=a(this),e=a(this).data("ajaxPager");if(settings.listeners.render&&typeof settings.listeners.render==="function"){settings.listeners.render.call(d,"render")}a("a.paging-nav",e.pagers).bind("click",{el:d},handlers.navLinkHandler);a(".navbar-form",e.pagers).bind("submit",handlers.jumpFormHandler);a(".navbar-form input",e.pagers).bind("keypress",function(b){c=b.which?b.which:b.keyCode;if(c===13){b.preventDefault();var d=a(this).parent();d.trigger("submit");return false}return true});if(!a.isEmptyObject(settings.sortby)){a("a.paging-filter",e.pagers).bind("click",{el:d},handlers.filterLinkHandler)}if(settings.limitdd){a("a.paging-limit",e.pagers).bind("click",{el:d},handlers.limitLinkHandler)}d.data("ajaxPager",a.extend(e,{rendered:true}));d.trigger("pagechange",settings.page)},beforeLoadHandler:function(b){var c=a(this);if(settings.listeners.beforeload&&typeof settings.listeners.beforeload==="function"){settings.listeners.beforeload.call(c,"beforeload")}},loadHandler:function(b){var c=a(this);if(settings.listeners.load&&typeof settings.listeners.load==="function"){settings.listeners.load.call(c,"load")}}},_buildPagerBar:function(b){var c='<div class="pagingbar ajaxPager'+(b.classes.length>0?" "+b.classes:"")+'">'+'<div class="pagingbar-inner">'+'<div class="container">'+'<div class="nav-collapse">'+'<ul class="nav nav-pills">'+'<li><a href="#first" class="paging-nav" rel="first">|&#171;</a></li>'+'<li class="divider-vertical"></li>'+'<li><a href="#previous" class="paging-nav" rel="previous">&#171;</a></li>'+'<li class="divider-vertical"></li>'+"</ul>"+'<form name="jump" class="navbar-form pull-left">'+'<strong>Page</strong> <input type="text" name="page" value="0" style="width:25px;" /> <strong>of <span class="total-pages">0</span></strong>'+"</form>"+'<ul class="nav nav-pills">'+'<li class="divider-vertical"></li>'+'<li><a href="#next" class="paging-nav" rel="next">&#187;</a></li>'+'<li class="divider-vertical"></li>'+'<li><a href="#last" class="paging-nav" rel="last">&#187;|</a></li>'+'<li class="divider-vertical"></li>';if(b.limitdd){c+='<li class="dropdown">'+'<a class="dropdown-toggle" data-toggle="dropdown" href="#">Limit<b class="caret"></b></a>'+'<ul class="dropdown-menu">';for(var d=0;d<b.limitoptions.length;d++){c+='<li><a href="#limit-'+b.limitoptions[d]+'" class="paging-limit" rel="'+b.limitoptions[d]+'"><i class="icon-'+(b.limitoptions[d]===b.limit?"chevron-right":"")+'"></i>'+b.limitoptions[d]+"</a></li>"}c+="</ul>"+"</li>"+'<li class="divider-vertical"></li>'}if(!a.isEmptyObject(b.sortby)){c+='<li class="dropdown">'+'<a class="dropdown-toggle" data-toggle="dropdown" href="#">Sort By<b class="caret"></b></a>'+'<ul class="dropdown-menu">';for(var d in b.sortby){c+='<li><a href="#filter-'+d+'" class="paging-filter" rel="'+d+'">';if(b.sortcolumn&&d===b.sortcolumn){if(b.sortdir==="asc"){c+='<i class="icon-arrow-up"></i> '}else if(b.sortcolumn&&b.sortdir==="desc"){c+='<i class="icon-arrow-down"></i> '}}else{c+='<i class="icon-"></i> '}c+=b.sortby[d]+"</a>"}c+="</ul>"+"</li>"+'<li class="divider-vertical"></li>'}c+="</ul>"+'<span class="pull-right navbar-text pagingbar-counts" style="margin-right:20px;">'+'<strong>View <span class="first-record">0</span> - <span class="last-record">0</span> of <span class="record-count">0</span></strong>'+"</span>"+"</div>"+"</div>"+"</div>"+"</div>";return c},_maskContent:function(b){var c=a(this);c.append('<div class="component-backdrop fade in" />').addClass("masked");if(b!==undefined){var d=a('<div class="mask-msg alert alert-info" style="display:none;"></div>');d.append("<div>"+b+"</div>");c.append(d);d.css("top",Math.round(c.height()/2-(d.height()-parseInt(d.css("padding-top"))-parseInt(d.css("padding-bottom")))/2)+"px");d.css("left",Math.round(c.width()/2-(d.width()-parseInt(d.css("padding-left"))-parseInt(d.css("padding-right")))/2)+"px");d.show()}},_unmaskContent:function(){var b=a(this);a("div.component-backdrop,div.mask-msg",b).remove();b.removeClass("masked")},_changePage:function(b,c,d){var e=a(this),f=a(this).data("ajaxPager");f=a.extend(f,{totalpages:c,totalrecords:d});switch(b){case 1:a('a.paging-nav[rel="first"], a.paging-nav[rel="previous"]',f.pagers).addClass("disabled");if(f.totalpages!==1){a('a.paging-nav[rel="next"], a.paging-nav[rel="last"]',f.pagers).removeClass("disabled")}else{a('a.paging-nav[rel="next"], a.paging-nav[rel="last"]',f.pagers).addClass("disabled")}break;case f.totalpages:a('a.paging-nav[rel="first"], a.paging-nav[rel="previous"]',f.pagers).removeClass("disabled");a('a.paging-nav[rel="next"], a.paging-nav[rel="last"]',f.pagers).addClass("disabled");break;default:a('a.paging-nav[rel="first"], a.paging-nav[rel="previous"]',f.pagers).removeClass("disabled");a('a.paging-nav[rel="next"], a.paging-nav[rel="last"]',f.pagers).removeClass("disabled");break}settings.page=b;var g=b*settings.limit;f=a.extend(f,{firstrecord:settings.limit*(b-1)+1,lastrecord:g>f.totalrecords?f.totalrecords:g});e.data("ajaxPager",f);a(".pagingbar-counts .first-record",f.pagers).html(f.firstrecord);a(".pagingbar-counts .last-record",f.pagers).html(f.lastrecord);a(".pagingbar-counts .record-count",f.pagers).html(f.totalrecords);a(".navbar-form .total-pages",f.pagers).html(f.totalpages);a('form[name="jump"] input[name="page"]',f.pagers).val(b)},_makeRequest:function(b){var c=a(this),d=a.extend({},settings.ajaxoptions),e={},f=settings,g=getAccessor;cp=changePage,u=unmask,data=c.data("ajaxPager"),target=data.target;e[settings.params.start]=(b-1)*settings.limit;e[settings.params.page]=b;e[settings.params.limit]=settings.limit;if(settings.sortcolumn){e[settings.params.sort]=settings.sortcolumn;e[settings.params.dir]=settings.sortdir}if(settings.searchtext){e[settings.params.search]=settings.searchtext}for(var h in d){if(d[h]===null){delete d[h]}}d.data=a.extend({},d.data,e);mask.call(c,f.loadtext);a.ajax(a.extend(d,{success:function(d,e,h){var i=null,j=null,k=null,l=null;d=f.listeners.preprocess&&typeof f.listeners.preprocess==="function"?f.listeners.preprocess.call(c,d):d;j=g(d,f.reader.root);k=parseInt(g(d,f.reader.totalpages));k=parseInt(k!=="undefined"?k:1);l=parseInt(g(d,f.reader.totalrecords));l=parseInt(l!==undefined?l:j.length);cp.call(c,b,k,l);i=f.renderoutput&&typeof f.renderoutput==="function"?f.renderoutput.call(c,d):d;c.trigger("beforeload");u.call(c,[]);target.html(i);if(f.stripedrows){c.children(":even").addClass("striped-row")}data=a.extend(data,{dataloaded:true});c.data("ajaxPager",data);c.trigger("load")},error:function(b,d,e){u.call(c,[]);a.error("There was an error in making your request. Please notify your developer.")}}))},_getAccessor:function(a,b){var c,d,e=[],f;if(typeof b==="function"){return b(a)}c=a[b];if(c===undefined){try{if(typeof b==="string"){e=b.split(".")}f=e.length;if(f){c=a;while(c&&f--){d=e.shift();c=c[d]}}}catch(g){}}return c}}})(jQuery)